<div class="list-container">
  <div class="list-header">
    <h1>My Complaints</h1>
    <button class="create-button" (click)="createNew()">
      + New Complaint
    </button>
  </div>

  <div class="filter-tabs">
    <button
      [class.active]="filterStatus === 'all'"
      (click)="filterByStatus('all')"
    >
      All ({{ complaints.length }})
    </button>
    <button
      [class.active]="filterStatus === 'Pending'"
      (click)="filterByStatus('Pending')"
    >
      Pending
    </button>
    <button
      [class.active]="filterStatus === 'In Progress'"
      (click)="filterByStatus('In Progress')"
    >
      In Progress
    </button>
    <button
      [class.active]="filterStatus === 'Resolved'"
      (click)="filterByStatus('Resolved')"
    >
      Resolved
    </button>
  </div>

  <div *ngIf="isLoading" class="loading">
    <p>Loading complaints...</p>
  </div>

  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>

  <div *ngIf="!isLoading && filteredComplaints.length === 0" class="empty-state">
    <p *ngIf="filterStatus === 'all'">
      You haven't submitted any complaints yet.
    </p>
    <p *ngIf="filterStatus !== 'all'">
      No {{ filterStatus.toLowerCase() }} complaints found.
    </p>
    <button class="create-button" (click)="createNew()">
      Submit Your First Complaint
    </button>
  </div>

  <div class="complaint-grid" *ngIf="!isLoading && filteredComplaints.length > 0">
    <div
      *ngFor="let complaint of filteredComplaints"
      class="complaint-card"
      (click)="viewDetails(complaint.id)"
    >
      <div class="card-header">
        <span class="complaint-number">{{ complaint.complaint_number }}</span>
        <span [class]="getStatusClass(complaint.status)" class="status-badge">
          {{ complaint.status }}
        </span>
      </div>

      <h3 class="complaint-subject">{{ complaint.subject }}</h3>

      <div class="complaint-meta">
        <div class="meta-item">
          <span class="meta-label">Category:</span>
          <span>{{ complaint.category?.category_name }}</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Priority:</span>
          <span [class]="getPriorityClass(complaint.priority)">
            {{ complaint.priority }}
          </span>
        </div>
        <div class="meta-item" *ngIf="complaint.location">
          <span class="meta-label">Location:</span>
          <span>{{ complaint.location }}</span>
        </div>
      </div>

      <div class="complaint-description">
        {{ complaint.description.length > 150 ? complaint.description.substring(0, 150) + '...' : complaint.description }}
      </div>

      <div class="card-footer">
        <span class="created-date">
          Submitted: {{ complaint.created_at | date:'medium' }}
        </span>
        <span class="view-link">View Details â†’</span>
      </div>
    </div>
  </div>
</div>
