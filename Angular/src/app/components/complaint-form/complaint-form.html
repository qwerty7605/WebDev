<div class="min-vh-100 bg-light py-5">
  <div class="container" style="max-width: 800px;">
    <div class="card shadow">
      <div class="card-body p-4">
        <div class="mb-4">
          <h1 class="h3 mb-2">Submit a Complaint</h1>
          <p class="text-muted">Please provide detailed information about your complaint</p>
        </div>

        <form (ngSubmit)="onSubmit()">
          <div class="mb-3">
            <label for="category" class="form-label">Category *</label>
            <select
              id="category"
              name="category"
              [(ngModel)]="formData.category_id"
              [disabled]="isLoading"
              required
              class="form-select"
            >
              <option value="0">Select a category</option>
              @for (category of categories; track category.id) {
                <option [value]="category.id">
                  {{ category.category_name }}
                </option>
              }
            </select>
          </div>

          <div class="mb-3">
            <label for="assignedTo" class="form-label">Assign to Admin (Optional)</label>
            <select
              id="assignedTo"
              name="assignedTo"
              [(ngModel)]="formData.assigned_to"
              [disabled]="isLoading"
              class="form-select"
            >
              <option value="0">Select an admin (optional)</option>
              @for (admin of admins; track admin.id) {
                <option [value]="admin.id">
                  {{ admin.full_name }} ({{ admin.role }})
                </option>
              }
            </select>
            <div class="form-text">Choose which admin will handle your complaint</div>
          </div>

          <div class="mb-3">
            <label for="subject" class="form-label">Subject *</label>
            <input
              type="text"
              id="subject"
              name="subject"
              [(ngModel)]="formData.subject"
              placeholder="Brief description of your complaint"
              [disabled]="isLoading"
              required
              maxlength="255"
              class="form-control"
            />
          </div>

          <div class="mb-3">
            <label for="description" class="form-label">Description *</label>
            <textarea
              id="description"
              name="description"
              [(ngModel)]="formData.description"
              placeholder="Provide detailed information about your complaint"
              [disabled]="isLoading"
              required
              rows="6"
              class="form-control"
            ></textarea>
          </div>

          <div class="mb-3">
            <label for="priority" class="form-label">Priority *</label>
            <select
              id="priority"
              name="priority"
              [(ngModel)]="formData.priority"
              [disabled]="isLoading"
              required
              class="form-select"
            >
              <option value="Low">Low</option>
              <option value="Medium">Medium</option>
              <option value="High">High</option>
            </select>
          </div>

          <div class="mb-3">
            <div class="form-check">
              <input
                type="checkbox"
                id="isAnonymous"
                name="isAnonymous"
                [(ngModel)]="formData.is_anonymous"
                [disabled]="isLoading"
                class="form-check-input"
              />
              <label for="isAnonymous" class="form-check-label">
                Submit anonymously
              </label>
            </div>
            <div class="form-text">Your identity will not be shown to admins if checked</div>
          </div>

          @if (errorMessage) {
            <div class="alert alert-danger" role="alert">
              {{ errorMessage }}
            </div>
          }

          @if (successMessage) {
            <div class="alert alert-success" role="alert">
              {{ successMessage }}
            </div>
          }

          <div class="d-flex gap-2 justify-content-end">
            <button
              type="button"
              class="btn btn-secondary"
              (click)="cancel()"
              [disabled]="isLoading"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="btn btn-primary"
              [disabled]="isLoading"
            >
              @if (!isLoading) {
                <span>Submit Complaint</span>
              }
              @if (isLoading) {
                <span>Submitting...</span>
              }
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
